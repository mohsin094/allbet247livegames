import{_,h as b,o as i,c as d,a as e,j as u,S as v,M as y,F as p,x as h,k as x,z as f,A as T,t as m,n as w,C as $,E as M}from"./index-5f4d758a.js";const S={},V={class:"modal fade",id:"newTicket",tabindex:"-1","aria-hidden":"true"},C={class:"modal-dialog"},D={class:"modal-content"},I=e("div",{class:"modal-header"},[e("h5",{class:"modal-title"},"New Ticket"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),F={class:"modal-body",style:{"text-align":"left"}},N={class:"modal-footer"};function B(s,t){const n=b("FormKit");return i(),d("div",V,[e("div",C,[e("div",D,[I,e("div",F,[u(n,{class:"less-padding",type:"text",label:"Title",modelValue:s.title,"onUpdate:modelValue":t[0]||(t[0]=a=>s.title=a)},null,8,["modelValue"]),u(n,{style:{"min-height":"150px"},type:"textarea",label:"Your message",rows:"20",modelValue:s.message,"onUpdate:modelValue":t[1]||(t[1]=a=>s.message=a)},null,8,["modelValue"])]),e("div",N,[e("button",{onClick:t[2]||(t[2]=a=>s.createTicket()),class:"btn btn-golden text-dark"},"Add new ticket")])])])])}const K=_(S,[["render",B]]),L="/assets/send-91522be2.svg";const E={components:{Sidebar:v,TicketModal:K},data(){return{tickets:[],messages:[],rplyTxt:"",title:"",message:"",newTicket:{},selectedTicket:""}},mounted(){this.getTicketList()},methods:{sendMsg(){const s="http://backgammon.all-bet-247.com/backend/web/ticket/default/reply?id="+this.selectedTicket;let t=this;this.$axios.post(s,{message:t.rplyTxt}).then(function(n){console.log(t.messages);const a=new Date,l=a.getHours()+":"+a.getMinutes();t.messages.push({id:"",message:t.rplyTxt,cdate:l}),t.rplyTxt=""})},convertDate(s){const t=new Date(s);let n=t.getFullYear(),a=t.getMonth();a=("0"+(a+1)).slice(-2);let l=t.getDate();l=("0"+l).slice(-2);let c=t.getHours();c=("0"+c).slice(-2);let r=t.getMinutes();r=("0"+r).slice(-2);let o=t.getSeconds();return o=("0"+o).slice(-2),`${n}/${a}/${l} ${c}:${r}:${o}`},getTicketList(){const s="http://backgammon.all-bet-247.com/backend/web/ticket/default/list";let t=this;this.$axios.get(s).then(function(n){let a=n.data.params;a.length>0&&(t.tickets=a)})},getTicket(s){this.selectedTicket=s;const t="http://backgammon.all-bet-247.com/backend/web/ticket/default/get";let n=this;this.$axios.get(t,{params:{id:s}}).then(function(a){let l=a.data.params;console.log(l),n.messages=l.messages,n.newTicket=l})},createTicket(){const s="http://backgammon.all-bet-247.com/backend/web/ticket/default/new";let t=this;this.$axios.post(s,{title:t.title,message:t.message}).then(function(n){if(n.data.result){var l=document.getElementById("newTicket"),c=y.getInstance(l);c.hide(),t.getTicketList()}})}}},g=s=>($("data-v-0fbe2422"),s=s(),M(),s),U=g(()=>e("div",{class:"row"},[e("div",{class:"col"},[e("button",{class:"btn btn-golden text-dark mt-3","data-bs-toggle":"modal","data-bs-target":"#newTicket"}," New ticket ")])],-1)),j={class:"row mt-3"},z={class:"col-md-6"},A=g(()=>e("div",{class:"sticky-header bg-dark-gradient text-center p-1 simple-page"},[e("h4",{class:"mt-3 mb-3"},"Ticket list")],-1)),H={class:"bg-dark-gradient text-center p-4 simple-page overflow-box position-relative mb-3",style:{height:"350px","overflow-y":"scroll"}},Y={key:0,class:"table table-responsive"},O=g(()=>e("thead",null,[e("tr",null,[e("th",null,"Title"),e("th",null,"Date"),e("th",null,"Status")])],-1)),W=["onClick"],q={class:"text-golden"},G={key:1,class:"vertical-center notif-text"},J={class:"col-md-6"},P=g(()=>e("div",{class:"sticky-header bg-dark-gradient text-center p-1 simple-page"},[e("h4",{class:"mt-3 mb-3"},"Messages")],-1)),Q={class:"bg-dark-gradient p-4 simple-page overflow-box position-relative msgs-wrapper"},R={key:0},X={key:1,class:"vertical-center notif-text"},Z={class:"input-group",style:{height:"50px"}},ee=["disabled"],te={class:"input-group-append"},se=["disabled"],le=g(()=>e("img",{src:L},null,-1)),ae=[le];function oe(s,t,n,a,l,c){const r=b("TicketModal");return i(),d("div",null,[U,e("div",j,[e("div",z,[A,e("div",H,[l.tickets.length>0?(i(),d("table",Y,[O,e("tbody",null,[(i(!0),d(p,null,h(l.tickets,o=>(i(),d("tr",{onClick:k=>c.getTicket(o._id)},[e("td",q,m(o.title),1),e("td",null,m(this.convertDate(Number(o.udate))),1),e("td",null,[e("strong",{class:w([{"text-grass":o.status=="open"},{"text-red":o.status=="closed"},{"text-golden-light":o.status=="user_pending"}])},m(o.status),3)])],8,W))),256))])])):(i(),d("p",G,"There is no ticket yet"))])]),e("div",J,[P,e("div",Q,[l.messages.length>0?(i(),d("div",R,[(i(!0),d(p,null,h(l.messages,o=>(i(),d("p",null,m(o.message),1))),256))])):(i(),d("p",X,"Select a ticket to start messaging"))]),e("div",Z,[x(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>l.rplyTxt=o),disabled:l.messages.length==0?"disabled":!1,onKeyup:t[1]||(t[1]=T(o=>c.sendMsg(),["enter"])),type:"text",class:"form-control msg-input",id:"input-msg",placeholder:"Write here...","aria-describedby":"basic-addon2"},null,40,ee),[[f,l.rplyTxt]]),e("div",te,[e("button",{onClick:t[2]||(t[2]=o=>c.sendMsg()),disabled:l.messages.length==0?"disabled":!1,class:"btn btn-outline-secondary msg-input",id:"send-msg",type:"button",style:{height:"50px"}},ae,8,se)])])])]),u(r)])}const ie=_(E,[["render",oe],["__scopeId","data-v-0fbe2422"]]);export{ie as default};
